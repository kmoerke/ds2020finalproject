---
title: "Keegan Ds2020 Final"
author: "Keegan Moerke"
date: "2024-12-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Abstract

The goal of this project is to find trends in the walkability of cities in Iowa.

```{r}
library(ggplot2)

```


```{r}

df <-  read.csv("EPA_SmartLocationDatabase_V3_Jan_2021_Final.csv")

head(df)
```

Here is a description of all the variables in the dataset.


Below shows restricting the data to just Iowa, then several plots comparing variables to walkability.
```{r}
 # This will install ggplot2 and other useful packages
library(tidyverse)

iowa_df = subset(df, `STATEFP` == 19)
# Assuming df is your dataframe
ggplot(data = iowa_df, aes(x = TotPop, y = NatWalkInd)) +
  geom_point() +
  labs(title = "Comparison of Total Population and National Walkability Index",
       x = "Total Population",
       y = "National Walkability Index") +
  theme_minimal()

ggplot(data = iowa_df, aes(x = AutoOwn0, y = NatWalkInd)) +
  geom_point() +
  labs(title = "Comparison of Percentage of households owning zero vehicles and National Walkability Index",
       x = "Num Households owning zero vehicles",
       y = "National Walkability Index") +
  theme_minimal()




# Convert data from wide to long format
long_df <- iowa_df %>%
  pivot_longer(cols = c(E_LowWageWk, E_MedWageWk, E_HiWageWk), names_to = "Variable", values_to = "Value")

# Plot the reshaped data
ggplot(data = long_df, aes(x = Value, y = NatWalkInd, color = Variable)) +
  geom_point() +
  labs(title = "Comparison of Walkability Index with Workers of different income",
       x = "Workers separated by wage classification",
       y = "National Walkability Index",
       color = "Variable") +
  theme_minimal()



```


```{r}
# Writing the dataframe to a CSV file
write.csv(iowa_df, file = "iowa_walkability_data.csv", row.names = FALSE)

```
```{r}

# Assuming 'iowa_df' is your dataframe and it has columns 'COUNTYFP' and 'NatWalkInd'
ggplot(data = iowa_df, aes(x = factor(CSA_Name), y = NatWalkInd)) +
  geom_boxplot() +
  labs(title = "Faceted Boxplot of Walkability by County",
       x = "County",
       y = "National Walkability Index") +
  facet_wrap(~ CSA_Name, nrow = 4) +
  theme_minimal()

```
This plot compares intersection density to walkability score
```{r}
library(ggplot2)
ggplot(data = iowa_df, aes(x = D3B, y = NatWalkInd)) +
  geom_point() +
  labs(title = "Comparison of Intersection Density and National Walkability Index",
       x = "Intersection Density",
       y = "National Walkability Index") +
  theme_minimal()
```

This plot shows distribution of each block by its walkability indexs weighted by population
```{r}
library(ggplot2)
# Histogram of National Walkability Index
ggplot(data = iowa_df, aes(x = NatWalkInd, weight = TotPop)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of National Walkability Index weighted by population",
       x = "National Walkability Index",
       y = "Frequency") +
  theme_minimal()

```
